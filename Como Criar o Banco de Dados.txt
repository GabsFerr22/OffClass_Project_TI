CREATE DATABASE IF NOT EXISTS offclass_db DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE offclass_db;



CREATE TABLE IF NOT EXISTS Instituicoes (
  id CHAR(36) PRIMARY KEY,
  nome VARCHAR(255) NOT NULL,
  email VARCHAR(255) NOT NULL UNIQUE,
  cnpj VARCHAR(20) NOT NULL UNIQUE,
  senha VARCHAR(255) NOT NULL,
  codigo_acesso VARCHAR(10) NOT NULL UNIQUE,
  createdAt DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updatedAt DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);


CREATE TABLE IF NOT EXISTS Usuarios (
  id CHAR(36) PRIMARY KEY,
  nome VARCHAR(255) NOT NULL,
  email VARCHAR(255) NOT NULL UNIQUE,
  senha VARCHAR(255) NOT NULL,
  codigo_escolar VARCHAR(10),
  createdAt DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updatedAt DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  CONSTRAINT fk_codigo_escolar FOREIGN KEY (codigo_escolar)
    REFERENCES Instituicoes(codigo_acesso)
    ON DELETE SET NULL
    ON UPDATE CASCADE
);